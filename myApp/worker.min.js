var SCWorker=require("socketcluster/scworker"),express=require("express"),serveStatic=require("serve-static"),path=require("path"),morgan=require("morgan"),healthChecker=require("sc-framework-health-check");class Worker extends SCWorker{run(){console.log("   >> Worker PID:",process.pid);var environment=this.options.environment,app=express(),httpServer=this.httpServer,scServer=this.scServer;"dev"===environment&&app.use(morgan("dev")),app.use(serveStatic(path.resolve(__dirname,"public"))),healthChecker.attach(this,app),httpServer.on("request",app);var userNames=[],Pieces=[{name:"WhiteKing",type:"King",color:"white",src:"chess_pieces/wk.svg",x:3,y:7},{name:"WhiteQueen",type:"Queen",color:"white",src:"chess_pieces/wq.svg",x:4,y:7},{name:"WhiteBishopLeft",type:"Bishop",color:"white",src:"chess_pieces/wb.svg",x:2,y:7},{name:"WhiteBishopRight",type:"Bishop",color:"white",src:"chess_pieces/wb.svg",x:5,y:7},{name:"WhiteKnightLeft",type:"Knight",color:"white",src:"chess_pieces/wn.svg",x:1,y:7},{name:"WhiteKnightRight",type:"Knight",color:"white",src:"chess_pieces/wn.svg",x:6,y:7},{name:"WhiteRookLeft",type:"Rook",color:"white",src:"chess_pieces/wr.svg",x:0,y:7},{name:"WhiteRookRight",type:"Rook",color:"white",src:"chess_pieces/wr.svg",x:7,y:7},{name:"WhitePawn0",type:"Pawn",color:"white",src:"chess_pieces/wp.svg",x:0,y:6},{name:"WhitePawn1",type:"Pawn",color:"white",src:"chess_pieces/wp.svg",x:1,y:6},{name:"WhitePawn2",type:"Pawn",color:"white",src:"chess_pieces/wp.svg",x:2,y:6},{name:"WhitePawn3",type:"Pawn",color:"white",src:"chess_pieces/wp.svg",x:3,y:6},{name:"WhitePawn4",type:"Pawn",color:"white",src:"chess_pieces/wp.svg",x:4,y:6},{name:"WhitePawn5",type:"Pawn",color:"white",src:"chess_pieces/wp.svg",x:5,y:6},{name:"WhitePawn6",type:"Pawn",color:"white",src:"chess_pieces/wp.svg",x:6,y:6},{name:"WhitePawn7",type:"Pawn",color:"white",src:"chess_pieces/wp.svg",x:7,y:6},{name:"BlackKing",type:"King",color:"black",src:"chess_pieces/bk.svg",x:3,y:0},{name:"BlackQueen",type:"Queen",color:"black",src:"chess_pieces/bq.svg",x:4,y:0},{name:"BlackBishopLeft",type:"Bishop",color:"black",src:"chess_pieces/bb.svg",x:2,y:0},{name:"BlackBishopRight",type:"Bishop",color:"black",src:"chess_pieces/bb.svg",x:5,y:0},{name:"BlackKnightLeft",type:"Knight",color:"black",src:"chess_pieces/bn.svg",x:1,y:0},{name:"BlackKnightRight",type:"Knight",color:"black",src:"chess_pieces/bn.svg",x:6,y:0},{name:"BlackRookLeft",type:"Rook",color:"black",src:"chess_pieces/br.svg",x:0,y:0},{name:"BlackRookRight",type:"Rook",color:"black",src:"chess_pieces/br.svg",x:7,y:0},{name:"BlackPawn0",type:"Pawn",color:"black",src:"chess_pieces/bp.svg",x:0,y:1},{name:"BlackPawn1",type:"Pawn",color:"black",src:"chess_pieces/bp.svg",x:1,y:1},{name:"BlackPawn2",type:"Pawn",color:"black",src:"chess_pieces/bp.svg",x:2,y:1},{name:"BlackPawn3",type:"Pawn",color:"black",src:"chess_pieces/bp.svg",x:3,y:1},{name:"BlackPawn4",type:"Pawn",color:"black",src:"chess_pieces/bp.svg",x:4,y:1},{name:"BlackPawn5",type:"Pawn",color:"black",src:"chess_pieces/bp.svg",x:5,y:1},{name:"BlackPawn6",type:"Pawn",color:"black",src:"chess_pieces/bp.svg",x:6,y:1},{name:"BlackPawn7",type:"Pawn",color:"black",src:"chess_pieces/bp.svg",x:7,y:1}];const checkLegalMove=piece=>{"Pawn"===piece.type&&"white"===piece.color&&piece.prevX===piece.x&&(piece.prevY===piece.y+1||void 0!==(Pieces.find(p=>p.name===piece.name).y===piece.y&&Pieces.find(p=>p.name===piece.name).x===piece.x)&&(piece.prevY,piece.y))};scServer.on("connection",function(socket){console.log("abc"),socket.on("test1",data=>{console.log(data)}),socket.on("validateUser",function(data,res){var err;data?userNames.indexOf(data)<0?(userNames.push(data.trim()),res(null,"Success")):res(null,"Failed"):res("Failed to connect")}),socket.on("moved",function(data,res){var err;(console.log(data),data)?res("fail",null):res(null,"Failed")}),socket.on("disconnect",function(){console.log("disconnected")})})}}new Worker;